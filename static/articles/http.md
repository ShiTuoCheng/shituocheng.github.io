#### HTTP浏览器缓存笔记
>(部分内容参考自《http权威指南)

##### 1.缓存的处理步骤（GET报文的基本缓存处理步骤）
###### （1）接收——缓存从网络中读取抵达的请求报文。
###### （2）解析——缓存对报文进行解析，提取出URL和各种首部。
###### （3）查询——缓存查看是否有本地副本可用，如果没有，就获取一份副本（并将其保存在本地）。
###### （4）新鲜度检测——缓存查看以缓存副本是否足够新鲜，如果不是，就询问服务器是否有任何更新。
###### （5）创建响应——缓存会用新的首部和已缓存的主体来构建一条相应报文。
###### （6）发送——缓存通过网络将相应发挥给客户端。
###### （7）日志——缓存可选地创建一个日志文件条目来描述这个事物。

##### 2.缓存分为强制缓存和协商缓存(对比缓存)
######  (1) 强制缓存：从缓存中取 状态吗为 200（from cache） 跟服务器不沟通，直接从缓存中取。
######  (2) 协商缓存：从缓存中取 状态码为 304（not modified） 通过服务器来告知缓存是否可用。

##### 3.强制缓存相关的header字段
######	服务器用http/1.0+的expires首部或者http/1.1的cache-control:max-age响应首部来指定过期日期。
###### （1）Expires: 指定一个绝对过期的日期。如果日期已经过了，就说明文档不再新鲜了。
###### （2）cache-control:max-age: 定义了文档的最大使用期——最大的合法生存时间(以秒为单位)。

###### 总结：这两个首部本质上是一样的。但是由于cache-control首部使用的是相对时间而不是绝对日期。所以我们更加倾向于使用较新的cache-control首部。绝对日期依赖于计算机的正确设置。

##### 4.协商缓存(对比缓存)
######  (1) Last-Modified/If-Modified-Since: 如果从指定日期之后文档被修改过了，就执行请求的方法。可以与Last-Modified服务器响应首部配合使用，只有在内容被修改后与已缓存版本有所不同的时候才获取内容。<br>只有自某个日期之后资源发生了变化的时候，IMS请求才会制定服务器执行请求:<br><br>(2) 如果自指定日期后，文档被修改了, if-modified-since条件就为真，通常get会执行。携带新首部的新文档会被返回给缓存，新首部除了其他信息之外，还包含了一个新的过期日期。<br><br>换句话说,服务器再次收到资源请求时，根据浏览器传过来If-Modified-Since和资源在服务器上的最后修改时间判断资源是否有变化，如果没有变化则返回304 Not Modified，但是不会返回资源内容；如果有变化，就正常返回资源内容。当服务器返回304 Not Modified的响应时，response header中不会再添加Last-Modified的header，因为既然资源没有变化，那么Last-Modified也就不会改变，这是服务器返回304时的response header。

###### (3) If-None-Match/Etags：服务器可以为文档提供特殊的标签，而不是将其与最近修改日期相匹配，这些标签就像序列号一样。如果缓存标签与服务器文档中的标签有所不同，If-None-Match首部就会执行所请求的方法。
